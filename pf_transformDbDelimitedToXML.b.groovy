/* @data
FG5764|^|05C|^|1|^|Acidic Species|^|45.0|^|2.0|^|6.0|^|0.166666666666667|^||^|iCE|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Acidic Species {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Acidic Species {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|45.6|^||^||^|%|^|Acidic Species {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958524E7|^|7.9958524E7|^|1183791.0|^|20210903 131153.000|^|62.0|^||^|Result <= MAX|^|<= 62.0% Acidic Species|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210917 223428.000|^|20210909 143837.000|^|20210826 000000.000|^|1 M|^|45.6|^||^||^||^||^||^||^||^|<= 62.0% Acidic Species
FG5764|^|05C|^|1|^|Anti-BCMA mAb|^|63.0|^|2.0|^|9.0|^|0.166666666666667|^||^|CEX-HPLC|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Anti-BCMA mAb {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Anti-BCMA mAb {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|0.3|^||^|<|^|%|^|Anti-BCMA mAb {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958483E7|^|7.9958483E7|^|1183791.0|^|20210903 131153.000|^|3.0|^||^|Result <= MAX|^|<= 3.0% anti BCMA parent mAb|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210929 173303.000|^|20210927 182500.000|^|20210826 000000.000|^|1 M|^|NMT 0.3|^||^||^||^||^||^||^||^|<= 3.0% anti BCMA parent mAb
FG5764|^|05C|^|1|^|Anti-BCMA/Anti-CD3 Bispecific Clip|^|63.0|^|2.0|^|9.0|^|0.166666666666667|^||^|CEX-HPLC|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Anti-BCMA/Anti-CD3 Bispecific Clip {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Anti-BCMA/Anti-CD3 Bispecific Clip {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|1.1|^||^||^|%|^|Anti-BCMA/Anti-CD3 Bispecific Clip {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958485E7|^|7.9958485E7|^|1183791.0|^|20210903 131153.000|^|5.0|^||^|Result <= MAX|^|<= 5.0% Bispecific mAb Clip|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210929 173303.000|^|20210927 182500.000|^|20210826 000000.000|^|1 M|^|1.1|^||^||^||^||^||^||^||^|<= 5.0% Bispecific mAb Clip
FG5764|^|05C|^|1|^|Anti-CD3 mAb|^|52.0|^|2.0|^|7.0|^|0.166666666666667|^||^|AEX-HPLC|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Anti-CD3 mAb {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Anti-CD3 mAb {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|0.1|^||^|<|^|%|^|Anti-CD3 mAb {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958467E7|^|7.9958467E7|^|1183791.0|^|20210903 131153.000|^|3.0|^||^|Result <= MAX|^|<= 3.0% anti CD3 parent mAb|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210929 173303.000|^|20210916 154216.000|^|20210826 000000.000|^|1 M|^|NMT 0.1|^||^||^||^||^||^||^||^|<= 3.0% anti CD3 parent mAb
FG5764|^|05C|^|1|^|Basic Species|^|45.0|^|2.0|^|6.0|^|0.166666666666667|^||^|iCE|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Basic Species {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Basic Species {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|12.1|^||^||^|%|^|Basic Species {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958525E7|^|7.9958525E7|^|1183791.0|^|20210903 131153.000|^|25.0|^||^|Result <= MAX|^|<= 25.0% Basic Species|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210917 223428.000|^|20210909 143837.000|^|20210826 000000.000|^|1 M|^|12.1|^||^||^||^||^||^||^||^|<= 25.0% Basic Species
FG5764|^|05C|^|1|^|Charge Isoforms|^|45.0|^|2.0|^|6.0|^|0.166666666666667|^||^|iCE|^||^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Charge Isoforms|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^||^||^||^|-|^|Charge Isoforms|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958546E7|^|7.9958546E7|^|1183791.0|^|20210903 131153.000|^||^||^|Equal to|^|Comparable to Reference Material|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210917 223428.000|^|20210909 143837.000|^|20210826 000000.000|^|1 M|^|Comparable to Reference Material|^||^||^||^||^||^||^||^|Comparable to Reference Material
FG5764|^|05C|^|1|^|Clarity [unrounded]|^|48.0|^|1.0|^|7.0|^|0.0833333333333333|^||^|Appearance|^||^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Clarity {NTU}|^|20210923 125739.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|6.0|^||^||^|NTU|^|Clarity {NTU}|^||^||^||^||^||^||^||^|BCMA|^||^|ACTIVE|^|48.0|^|FG5764|^|H000025594 STABILITY|^|VIAL - 5 ML|^|7.0|^|0.0833333333333333|^|4.29822839E8|^|4.29822839E8|^|2.09463715E8|^|20210823 020232.000|^|18.0|^||^|<= 18|^|NEPHELOMETRIC TURBIDITY UNITS|^|INVERTED|^|20210706 000000.000|^|Drug Product|^||^|20210823 020232.000|^|20210823 020232.000|^|1 M|^|6|^||^||^||^||^||^||^||^|NEPHELOMETRIC TURBIDITY UNITS
FG5764|^|05C|^|1|^|Coloration [unrounded]|^|48.0|^|1.0|^|7.0|^|0.0833333333333333|^||^|Appearance|^||^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Coloration|^|20210923 125739.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^||^||^||^|-|^|Coloration|^||^||^||^||^||^||^||^|BCMA|^||^|ACTIVE|^|48.0|^|FG5764|^|H000025594 STABILITY|^|VIAL - 5 ML|^|7.0|^|0.0833333333333333|^|4.2982284E8|^|4.2982284E8|^|2.09463715E8|^|20210823 020232.000|^||^||^|MEETS TEST Not more intensely colored than level 5 of the brown color standard.|^|MEETS TEST|^|INVERTED|^|20210706 000000.000|^|Drug Product|^||^|20210823 020232.000|^|20210823 020232.000|^|1 M|^|MEETS TEST|^||^||^||^||^||^||^||^|MEETS TEST
FG5764|^|05C|^|1|^|Fragments|^|47.0|^|2.0|^|6.0|^|0.166666666666667|^||^|CGE (reducing)|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Fragments {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Fragments {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|0.8|^||^||^|%|^|Fragments {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958498E7|^|7.9958498E7|^|1183791.0|^|20210903 131153.000|^|10.0|^||^|Result <= MAX|^|<= 10.0% Fragments|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210917 223428.000|^|20210911 143322.000|^|20210826 000000.000|^|1 M|^|0.8|^||^||^||^||^||^||^||^|<= 10.0% Fragments
FG5764|^|05C|^|1|^|Fragments|^|51.0|^|2.0|^|7.0|^|0.166666666666667|^||^|CGE (non-reducing)|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Fragments {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Fragments {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|0.3|^||^|<|^|%|^|Fragments {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958491E7|^|7.9958491E7|^|1183791.0|^|20210903 131153.000|^|5.0|^||^|Result <= MAX|^|<= 5.0 % Fragments|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210917 223428.000|^|20210915 163059.000|^|20210826 000000.000|^|1 M|^|NMT 0.3|^||^||^||^||^||^||^||^|<= 5.0 % Fragments
FG5764|^|05C|^|1|^|HMMS|^|53.0|^|2.0|^|7.0|^|0.166666666666667|^||^|SE-HPLC|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:HMMS {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:HMMS {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|0.2|^||^|<|^|%|^|HMMS {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958713E7|^|7.9958713E7|^|1183791.0|^|20210903 131153.000|^|4.0|^||^|Result <= MAX|^|<= 4.0% HMMS|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210929 173303.000|^|20210917 201009.000|^|20210826 000000.000|^|1 M|^|NMT 0.2|^||^||^||^||^||^||^||^|<= 4.0% HMMS
FG5764|^|05C|^|1|^|Heavy Chain + Light Chain|^|47.0|^|2.0|^|6.0|^|0.166666666666667|^||^|CGE (reducing)|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Heavy Chain + Light Chain {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Heavy Chain + Light Chain {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|99.2|^||^||^|%|^|Heavy Chain + Light Chain {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958497E7|^|7.9958497E7|^|1183791.0|^|20210903 131153.000|^||^|90.0|^|Result >= MIN|^|>= 90.0% IgG as heavy + light chain|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210917 223428.000|^|20210911 143322.000|^|20210826 000000.000|^|1 M|^|99.2|^||^||^||^||^||^||^||^|>= 90.0% IgG as heavy + light chain
FG5764|^|05C|^|1|^|Intact IgG|^|51.0|^|2.0|^|7.0|^|0.166666666666667|^||^|CGE (non-reducing)|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Intact IgG {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Intact IgG {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|100.0|^||^||^|%|^|Intact IgG {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.995849E7|^|7.995849E7|^|1183791.0|^|20210903 131153.000|^||^|92.0|^|Result >= MIN|^|>= 92.0% IgG|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210917 223428.000|^|20210915 163059.000|^|20210826 000000.000|^|1 M|^|100.0|^||^||^||^||^||^||^||^|>= 92.0% IgG
FG5764|^|05C|^|1|^|Main Species|^|45.0|^|2.0|^|6.0|^|0.166666666666667|^||^|iCE|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Main Species {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Main Species {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|42.3|^||^||^|%|^|Main Species {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958523E7|^|7.9958523E7|^|1183791.0|^|20210903 131153.000|^||^|25.0|^|Result >= MIN|^|>= 25.0% Main Species|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210917 223428.000|^|20210909 143837.000|^|20210826 000000.000|^|1 M|^|42.3|^||^||^||^||^||^||^||^|>= 25.0% Main Species
FG5764|^|05C|^|1|^|Methionine Oxidation|^|43.0|^|2.0|^|6.0|^|0.166666666666667|^||^|Methionine Oxidation|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Methionine Oxidation {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Methionine Oxidation {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|1.3|^||^||^|%|^|Methionine Oxidation {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958675E7|^|7.9958675E7|^|1183791.0|^|20210903 131153.000|^||^||^||^||^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210914 130113.000|^|20210907 204646.000|^|20210826 000000.000|^|1 M|^|1.3|^||^||^||^||^||^||^||^|-none-
FG5764|^|05C|^|1|^|Monomer|^|53.0|^|2.0|^|7.0|^|0.166666666666667|^||^|SE-HPLC|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Monomer {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Monomer {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|99.9|^||^||^|%|^|Monomer {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958711E7|^|7.9958711E7|^|1183791.0|^|20210903 131153.000|^||^|92.0|^|Result >= MIN|^|>= 92.0% monomer|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210929 173303.000|^|20210917 201009.000|^|20210826 000000.000|^|1 M|^|99.9|^||^||^||^||^||^||^||^|>= 92.0% monomer
FG5764|^|05C|^|1|^|Other|^|47.0|^|2.0|^|6.0|^|0.166666666666667|^||^|CGE (reducing)|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Other {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Other {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|0.3|^||^|<|^|%|^|Other {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958499E7|^|7.9958499E7|^|1183791.0|^|20210903 131153.000|^||^||^||^||^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210917 223428.000|^|20210911 143322.000|^|20210826 000000.000|^|1 M|^|NMT 0.3|^||^||^||^||^||^||^||^|-none-
FG5764|^|05C|^|1|^|Other|^|51.0|^|2.0|^|7.0|^|0.166666666666667|^||^|CGE (non-reducing)|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Other {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Other {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|0.3|^||^|<|^|%|^|Other {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958492E7|^|7.9958492E7|^|1183791.0|^|20210903 131153.000|^||^||^||^||^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210917 223428.000|^|20210915 163059.000|^|20210826 000000.000|^|1 M|^|NMT 0.3|^||^||^||^||^||^||^||^|-none-
FG5764|^|05C|^|1|^|Protein Concentration [unrounded]|^|48.0|^|1.0|^|7.0|^|0.0833333333333333|^||^|UV Spectroscopy|^||^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Protein Concentration {mg/mL}|^|20210913 104244.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|41.3|^||^||^|mg/mL|^|Protein Concentration {mg/mL}|^||^||^||^||^||^||^||^|BCMA|^||^|ACTIVE|^|48.0|^|FG5764|^|H000025594 STABILITY|^|VIAL - 5 ML|^|7.0|^|0.0833333333333333|^|4.29822836E8|^|4.29822836E8|^|2.09463715E8|^|20210823 020232.000|^|44.0|^|36.0|^|36.0 - 44.0Report to one decimal place|^|MILLIGRAMS PER MILLILITER|^|INVERTED|^|20210706 000000.000|^|Drug Product|^||^|20210823 020232.000|^|20210823 020232.000|^|1 M|^|41.3|^||^||^||^||^||^||^||^|MILLIGRAMS PER MILLILITER
FG5764|^|05C|^|1|^|Relative Potency|^|39.0|^|2.0|^|5.0|^|0.166666666666667|^||^|Cell-based Bioassay|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Relative Potency {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Relative Potency {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|111.0|^||^||^|%|^|Relative Potency {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958472E7|^|7.9958472E7|^|1183791.0|^|20210903 131153.000|^|150.0|^|50.0|^|MIN <= Result <= MAX|^|50 - 150% potency relative to reference material|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210914 162622.000|^|20210903 131153.000|^|20210826 000000.000|^|1 M|^|111|^||^||^||^||^||^||^||^|50 - 150% potency relative to reference material
FG5764|^|05C|^|1|^|Relative Potency|^|51.0|^|2.0|^|7.0|^|0.166666666666667|^||^|Biological Activity (Binding ELISA)|^|\\amrsomw557\Informa-reports\Non-GMP\BCMA\Stability\Filing\DP Cross Source\BCMA DP Scatterplot Stability Charts_files\BCMA:Kalamazoo:Drug Product:05C:Relative Potency {%}.png|^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Relative Potency {%}|^|20210929 174709.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|96.0|^||^||^|%|^|Relative Potency {%}|^||^||^||^||^||^||^||^|BCMA|^|PF-06863135:1|^|P|^|31.0|^|PF-06863135:1-023|^|GEN_REGIST|^|FG5764|^|4.0|^|0.0833333333333333|^|7.9958477E7|^|7.9958477E7|^|1183791.0|^|20210903 131153.000|^|150.0|^|50.0|^|MIN <= Result <= MAX|^|50 - 150% potency relative to reference material|^|INVERTED|^|20210726 000000.000|^|Drug Product|^|20210929 173303.000|^|20210915 204937.000|^|20210826 000000.000|^|1 M|^|96|^||^||^||^||^||^||^||^|50 - 150% potency relative to reference material
FG5764|^|05C|^|1|^|Visible Particulates [unrounded]|^|48.0|^|1.0|^|7.0|^|0.0833333333333333|^||^|Appearance|^||^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:Visible Particulates|^|20210923 125739.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^||^||^||^|-|^|Visible Particulates|^||^||^||^||^||^||^||^|BCMA|^||^|ACTIVE|^|48.0|^|FG5764|^|H000025594 STABILITY|^|VIAL - 5 ML|^|7.0|^|0.0833333333333333|^|4.29822837E8|^|4.29822837E8|^|2.09463715E8|^|20210823 020232.000|^||^||^|MEETS TEST Essentially free from visible particulates|^|MEETS TEST|^|INVERTED|^|20210706 000000.000|^|Drug Product|^||^|20210823 020232.000|^|20210823 020232.000|^|1 M|^|MEETS TEST|^||^||^||^||^||^||^||^|MEETS TEST
FG5764|^|05C|^|1|^|pH [unrounded]|^|48.0|^|1.0|^|7.0|^|0.0833333333333333|^||^|pH|^||^||^||^||^|BCMA:Kalamazoo:Drug Product:05C:pH|^|20210915 164954.000|^|Pfizer|^|Kalamazoo|^|H000025594|^||^|5.7|^||^||^|-|^|pH|^||^||^||^||^||^||^||^|BCMA|^||^|ACTIVE|^|48.0|^|FG5764|^|H000025594 STABILITY|^|VIAL - 5 ML|^|7.0|^|0.0833333333333333|^|4.29822838E8|^|4.29822838E8|^|2.09463715E8|^|20210823 020232.000|^|6.3|^|5.3|^|5.3 - 6.3|^|NONE|^|INVERTED|^|20210706 000000.000|^|Drug Product|^||^|20210823 020232.000|^|20210823 020232.000|^|1 M|^|5.7|^||^||^||^||^||^||^||^|NONE
*/

/* @Props
DPP_STAB_ColumnNames="Batch Number", "Stab Storage Condition", "Protocol Months On Stability", "Parameter Field Name", "Actual Days On Stability", "Actual Months On Stability", "Actual Weeks On Stability", "Actual Years On Stability", "Assay Method", "Assay Name", "Chart Image Location", "Date Parameter Value", "Date of Manufacture", "Days On Stability since DOM", "Grouping Parameter", "Last Modification Date", "Manufacture Company", "Manufacture Site", "Material Number", "Months On Stability since DOM", "Numeric Parameter Value", "Parameter Category", "Parameter Entry Qualifier", "Parameter Units", "Parameter _w_Units_ Field Name", "Process Variation", "Product Category 1 Name", "Product Category 1 Value", "Product Category 2 Name", "Product Category 2 Value", "Product Category 3 Name", "Product Category 3 Value", "Product Name", "Project Name", "Project Status", "Protocol Days On Stability", "Protocol Name", "Protocol Template", "Protocol Test Article", "Protocol Weeks On Stability", "Protocol Years On Stability", "Result ID", "Result Number", "Sample Number", "Sample Start Date", "Spec Max Value", "Spec Min Value", "Spec Rule", "Spec Text Value", "Stab Storage Orientation", "Stability Base Date", "Sub Product Name", "Test Review Date", "Test Start Date", "Testing Target Date", "Testing Time Point", "Text Parameter Value", "Validation State", "Weeks On Stability since DOM", "Worklist Name", "Years On Stability since DOM", "Investigation", "Serotype", "Suite", "Spec Description"
DPP_STAB_UsedColumns="Parameter Field Name","Assay Name","Numeric Parameter Value","Parameter Units","Spec Max Value","Spec Min Value","Spec Rule","Spec Text Value","Text Parameter Value", "Spec Description"
DPP_STAB_AssayNamesColIndex=9
DPP_STAB_FieldNamesColIndex=3
DPP_FieldValueColIndex=56

document.dynamic.userdefined.DDP_STAB_LotNumber=LOT123

document.dynamic.userdefined.DDP_STAB_UsedFieldsCsv=Appearance|^|Visible Particulates|^|1|^|1|^|10|^|n\n
Appearance|^|Clarity|^|1|^|2|^|7|^|n\n
Appearance|^|Coloration|^|1|^|3|^|10|^|n\n
pH|^|pH|^|1|^|4|^|4|^|n\n
UV Spectroscopy|^|Protein Concentration|^|1|^|5|^|11|^|n\n
Subvisible Particles|^|Subvisible Particles >= 10µm|^|1|^|6|^|11|^|n\n
Subvisible Particles|^|Subvisible Particles >= 25µm|^|1|^|7|^|11|^|n\n
iCE|^|Acidic Species|^|1|^|8|^|9|^|n\n
iCE|^|Main Species|^|1|^|9|^|9|^|n\n
iCE|^|Basic Species|^|1|^|10|^|9|^|n\n
SE-HPLC|^|Monomer|^|2|^|11|^|8|^|n\n
SE-HPLC|^|HMMS|^|2|^|12|^|7|^|n\n
CGE (reducing)|^|Heavy Chain + Light Chain|^|2|^|13|^|9|^|n\n
CGE (reducing)|^|Fragments|^|2|^|14|^|10|^|n\n
CGE (non-reducing)|^|Intact IgG|^|2|^|15|^|8|^|n\n
CGE (non-reducing)|^|Fragments|^|2|^|16|^|10|^|n\n
Cell-based Bioassay|^|Relative Potency|^|2|^|17|^|10|^|yes\n
Biological Activity (Binding ELISA)|^|Relative Potency|^|2|^|18|^|10|^|n\n
AEX-HPLC|^|Anti-CD3 mAb|^|2|^|19|^|9|^|n\n
CEX-HPLC|^|Anti-BCMA mAb|^|2|^|20|^|8|^|n\n
CEX-HPLC|^|Anti-BCMA/Anti-CD3 Bispecific Clip|^|2|^|21|^|8|^|n\n
Container Closure Integrity|^|Dye Ingress|^|2|^|22|^|8|^|n\n
Sterility|^|Sterility|^|2|^|24|^|8|^|n

document.dynamic.userdefined.DDP_STAB_GroupByValue=0.0

document.dynamic.userdefined.DDP_STAB_GroupByLabel=Time(Months)
*/

// nothing

import java.util.Properties;
import java.io.InputStream;
import com.boomi.execution.ExecutionUtil;
import groovy.xml.MarkupBuilder;

logger = ExecutionUtil.getBaseLogger();

def dataColumnDelimiter = /\|\^\|/
// logger.warning("dataColumnDelimiter: " + dataColumnDelimiter)

// get DPPs from Constants
def dbAllColumns = ExecutionUtil.getDynamicProcessProperty("DPP_STAB_ColumnNames")
// logger.warning("dbAllColumns: " + dbAllColumns)
def dbAllColumnsArr = dbAllColumns.trim().split(/\s*,\s*/)
// logger.warning("dbAllColumnsArr: " + dbAllColumnsArr)
def dbUsedColumns = ExecutionUtil.getDynamicProcessProperty("DPP_STAB_UsedColumns")
// logger.warning("dbUsedColumns: " + dbUsedColumns)
def dbUsedColumnsArr = dbUsedColumns.trim().split(/\s*,\s*/)
// logger.warning("dbUsedColumnsArr: " + dbUsedColumnsArr)
int dbAssayNameColIndex = ExecutionUtil.getDynamicProcessProperty("DPP_STAB_AssayNamesColIndex") as int
// logger.warning("dbAssayNameColIndex: " + dbAssayNameColIndex.toString())
int dbFieldNameColIndex = ExecutionUtil.getDynamicProcessProperty("DPP_STAB_FieldNamesColIndex") as int
// logger.warning("dbFieldNameColIndex: " + dbFieldNameColIndex.toString())
int dbFieldValueColIndex = ExecutionUtil.getDynamicProcessProperty("DPP_STAB_FieldValueColIndex") as int
// logger.warning("dbFieldValueColIndex: " + dbFieldValueColIndex.toString())

for( int i = 0; i < dataContext.getDataCount(); i++ ) {
    InputStream is = dataContext.getStream(i);
    Properties props = dataContext.getProperties(i);
    
    reader = new BufferedReader(new InputStreamReader(is));
    
    // get DDPs
    def dbLotNumber = props.getProperty("document.dynamic.userdefined.DDP_STAB_LotNumber")
    // logger.warning("dbLotNumber: " + dbLotNumber)
    
    def usedFields = props.getProperty("document.dynamic.userdefined.DDP_STAB_UsedFieldsCsv")
    // logger.warning("usedFields: " + usedFields)
    def usedFieldsArr = usedFields.trim().split("\n")
    // logger.warning("usedFieldsArr: " + usedFieldsArr)
    
    def dbGroupByValue = props.getProperty("document.dynamic.userdefined.DDP_STAB_GroupByValue")
    // logger.warning("dbGroupByValue: " + dbGroupByValue)
    def dbGroupByLabel = props.getProperty("document.dynamic.userdefined.DDP_STAB_GroupByLabel")
    // logger.warning("dbGroupByLabel: " + dbGroupByLabel)

    //construct dataRowMap
    def dataRowMap = [:]
    def dataRowArrWidth = 0
    while ((dataRow = reader.readLine()) != null) {
        def dataRowArr = dataRow.split(dataColumnDelimiter)
        if (dataRowArrWidth == 0) dataRowArrWidth = dataRowArr.size()
        dataRowMap."${dataRowArr[dbAssayNameColIndex].toUpperCase()}__${dataRowArr[dbFieldNameColIndex].toUpperCase()}" = dataRowArr
        // logger.warning(dataRowArr.size() + ": ${dataRowArr[dbAssayNameColIndex]}__${dataRowArr[dbFieldNameColIndex]}: " + dataRowArr)
    }
    // logger.warning("dataRowMap: " + dataRowMap)

    // construct usedFieldsMap
    def usedFieldsMap = [:]
    int numTables = 1
    usedFieldsArr.each() { usedFieldsRowStr ->
        def usedFieldsRowArr = usedFieldsRowStr.trim().split(/\s*\|\^\|\s*/)
        def assay = usedFieldsRowArr[0]
        def parameter = usedFieldsRowArr[1]
        int tableNum = usedFieldsRowArr[2] as int
        def column = usedFieldsRowArr[3]
        def width = usedFieldsRowArr[4]
        
        if (tableNum > numTables) numTables = tableNum
        usedFieldsMap."${assay.toUpperCase()}__${parameter.toUpperCase()}" = [assay,parameter,tableNum,column,width]
    }
    // logger.warning("usedFieldsMap: " + usedFieldsMap)

    // Set DDP for use later to separate the one table which is the result of this script into multiple tables
    props.setProperty("document.dynamic.userdefined.DDP_STAB_NumTables", numTables.toString())
    // logger.warning("numTables: " + DDP_STAB_NumTables)

    // init XML construction
    // http://docs.groovy-lang.org/docs/groovy-2.4.10/html/api/groovy/xml/MarkupBuilder.html [docs.groovy-lang.org] [docs.groovy-lang.org]
    def xmlWriter = new StringWriter()
    def xmlMarkup = new MarkupBuilder(xmlWriter)
    
    // construct XML
    xmlMarkup.'StabilityData'() {
        'Batch'('LotNumber':dbLotNumber) {
            // for each table... allows for reset of columnSequenceNum per table
                    'DataRow'('GroupByLabel':dbGroupByLabel, 'GroupByValue':dbGroupByValue){
            (1..numTables).each() { tableIndex ->
                int columnSequenceNum = 1
                // 'Table'('TableIndex':tableIndex) {
                // 'Table'() {
                        usedFieldsMap.each() { assay__field, indicesArr ->
                            def usedAssay = indicesArr[0]
                            def usedParamater = indicesArr[1]
                            def usedTableIndex = indicesArr[2]
                            def usedColumnIndex = indicesArr[3]
                            def usedWidth = indicesArr[4]
                            
                            // if (usedTableIndex == tableIndex) { //     <-- possibly change to startsWith()
                            if (tableIndex.startsWith(usedTableIndex)) {
                                
                                'Field'('TableIndex':usedTableIndex, 'ColumnIndex':usedColumnIndex,'ColumnSeqence':columnSequenceNum,'ColumnWidth':usedWidth, \
                                            'Key':assay__field) {

                                    // if a field is in the usedFields but not in the data, create a row for it in the data.
                                    if (!dataRowMap."${assay__field}") {
                                        def fillerDataRowArr = []
                                        // fill all fields with N/A except for the ParameterFieldName field,
                                        // fill that with the ParameterFieldName
                                        (0..dataRowArrWidth-1).each() { k ->
                                            // logger.warning("k: " + k + " dbFieldNameColIndex: " + dbFieldNameColIndex)
                                            if (k == dbAssayNameColIndex) fillerDataRowArr[k] = usedAssay
                                            else if (k == dbFieldNameColIndex) fillerDataRowArr[k] = usedParamater
                                            else if (k == dbFieldValueColIndex) fillerDataRowArr[k] = "NT"
                                            else fillerDataRowArr[k] = ""
                                        }
                                        dataRowMap."${assay__field}" = fillerDataRowArr
                                    }
                                    dataRowMap."${assay__field}".eachWithIndex() { rowItem, j ->
                                        // only create and xml node if the column is in the usedDbColunsArr
                                        if (dbUsedColumnsArr.contains(dbAllColumnsArr[j].trim())) {
                                            // logger.warning("TRUE")
                                            "${dbAllColumnsArr[j].replaceAll(/\W/,"")}"("${groovy.json.StringEscapeUtils.escapeJava(rowItem)}")
                                        }
                                    }
                                }
                                columnSequenceNum++
                            }
                        }
                    }
                // }
            }
        }
    }
    // logger.warning(xmlWriter.toString()) //.replaceAll(/>\s+</,"")

    is = new ByteArrayInputStream(xmlWriter.toString().getBytes("UTF-8"));
    dataContext.storeStream(is, props);
}

