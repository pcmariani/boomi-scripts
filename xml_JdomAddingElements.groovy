/* @data
<ns1:ReturnAuthorization xmlns:ns1="urn:customers_2016_2.transactions.webservices.netsuite.com" xmlns:ns2="urn:core_2016_2.platform.webservices.netsuite.com" xmlns:ns3="urn:common_2016_2.platform.webservices.netsuite.com" externalId="01d3a229-818e-11e9-b18e-1686342107249_1686342107249_Refund_RA">
  <ns1:createdDate>2019-09-19T00:51:00.000-04:00</ns1:createdDate>
  <ns1:lastModifiedDate>2019-10-22T09:12:00.000-04:00</ns1:lastModifiedDate>
  <ns1:customForm internalId="122">
    DJ Return Authorization - Credit
    <ns2:name>DJ Return Authorization - Credit</ns2:name>
  </ns1:customForm>
  <ns1:entity internalId="3889265">
    <ns2:name>CUST168247 Shaman D''Souza</ns2:name>
  </ns1:entity>
  <ns1:tranDate>2019-10-21T14:17:32.000-04:00</ns1:tranDate>
  <ns1:tranId>To Be Generated</ns1:tranId>
  <ns1:source>Web Services</ns1:source>
  <ns1:department internalId="4">
    <ns2:name>Merchandising</ns2:name>
  </ns1:department>
  <ns1:location internalId="16"/>
  <ns1:memo>Refund Option: Refund</ns1:memo>
  <ns1:salesEffectiveDate>2019-09-19T00:00:00.000-04:00</ns1:salesEffectiveDate>
  <ns1:createdFrom internalId="10940144">
    <ns2:name>Sales Order #SO258633</ns2:name>
  </ns1:createdFrom>
  <ns1:totalCostEstimate>81.23</ns1:totalCostEstimate>
  <ns1:estGrossProfit>237.47</ns1:estGrossProfit>
  <ns1:estGrossProfitPercent>74.5121</ns1:estGrossProfitPercent>
  <ns1:billingAddress>
    <ns3:country>_unitedStates</ns3:country>
    <ns3:addr1>6 LAKE BELLEVUE DR APT 211</ns3:addr1>
    <ns3:city>BELLEVUE</ns3:city>
    <ns3:state>WA</ns3:state>
    <ns3:zip>98005-2428</ns3:zip>
    <ns3:addrText>6 LAKE BELLEVUE DR APT 211
BELLEVUE WA 98005-2428
United States</ns3:addrText>
    <ns3:override>false</ns3:override>
  </ns1:billingAddress>
  <ns1:subTotal>318.7</ns1:subTotal>
  <ns1:discountTotal>0.0</ns1:discountTotal>
  <ns1:total>352.6</ns1:total>
  <ns1:email>shaman327@yahoo.com</ns1:email>
  <ns1:taxTotal>33.9</ns1:taxTotal>
  <ns1:orderStatus>_pendingReceipt</ns1:orderStatus>
  <ns1:itemList>
    <ns1:item>
      <ns1:item internalId="47592">
        <ns2:name>DRD0567P : DRD0567P40116X Belted Chambray Shirtdress</ns2:name>
      </ns1:item>
      <ns1:orderLine>1</ns1:orderLine>
      <ns1:line>1</ns1:line>
      <ns1:quantity>1</ns1:quantity>
      <ns1:quantityReceived>1.0</ns1:quantityReceived>
      <ns1:price internalId="-1"/>
      <ns1:rate>115.00</ns1:rate>
      <ns1:isDropShipment>false</ns1:isDropShipment>
      <ns1:costEstimateType>_averageCost</ns1:costEstimateType>
      <ns1:costEstimate>29.72</ns1:costEstimate>
      <ns1:location internalId="16"/>
      <ns1:taxCode internalId="7126">
        <ns2:name>AVATAX</ns2:name>
      </ns1:taxCode>
      <ns1:taxRate1>10.0</ns1:taxRate1>
      <ns1:customFieldList>
        <ns2:Apply_WH_Tax_ internalId="1135" scriptId="custcol_4601_witaxapplies">
          false
          <ns2:value>false</ns2:value>
        </ns2:Apply_WH_Tax_>
        <ns2:Product_Color_Description internalId="1272" scriptId="custcol_dj_product_color_description">
          <ns2:value>Dark Wash</ns2:value>
        </ns2:Product_Color_Description>
        <ns2:Reason_for_Return>
          <ns2:value>changed_my_mind</ns2:value>
        </ns2:Reason_for_Return>
        <ns2:Item_Type internalId="2101" scriptId="custcol9">
          <ns2:value>Inventory Item</ns2:value>
        </ns2:Item_Type>
      </ns1:customFieldList>
    </ns1:item>
    <ns1:item>
      <ns1:item internalId="7108">
        <ns2:name>Discount Item Discount Item</ns2:name>
      </ns1:item>
      <ns1:orderLine>2</ns1:orderLine>
      <ns1:line>2</ns1:line>
      <ns1:price internalId="-1"/>
      <ns1:rate>-10.00%</ns1:rate>
      <ns1:isDropShipment>false</ns1:isDropShipment>
      <ns1:location internalId="16"/>
      <ns1:taxCode internalId="7126">
        <ns2:name>AVATAX</ns2:name>
      </ns1:taxCode>
      <ns1:taxRate1>0.0</ns1:taxRate1>
      <ns1:customFieldList>
        <ns2:Apply_WH_Tax_ internalId="1135" scriptId="custcol_4601_witaxapplies">
          false
          <ns2:value>false</ns2:value>
        </ns2:Apply_WH_Tax_>
        <ns2:Item_Type internalId="2101" scriptId="custcol9">
          <ns2:value>Discount</ns2:value>
        </ns2:Item_Type>
      </ns1:customFieldList>
    </ns1:item>
  </ns1:itemList>
  <ns1:customFieldList>
    <ns2:Returns_Channel>
      <ns2:value>By mail</ns2:value>
    </ns2:Returns_Channel>
    <ns2:Document_Date internalId="688" scriptId="custbody_document_date">
      <ns2:value>2019-09-19T00:00:00.000-04:00</ns2:value>
    </ns2:Document_Date>
    <ns2:Gift_Wrap internalId="1327" scriptId="custbody_gift_wrap">
      <ns2:value>false</ns2:value>
    </ns2:Gift_Wrap>
    <ns2:Is_Seller_Importer_Of_Record internalId="1984" scriptId="custbody_ava_is_sellerimporter">
      false
      <ns2:value>false</ns2:value>
    </ns2:Is_Seller_Importer_Of_Record>
    <ns2:Order_Type internalId="1273" scriptId="custbody_dj_ordertype">
      <ns2:value internalId="1" typeId="225">
        Web
        <ns2:name>Web</ns2:name>
      </ns2:value>
    </ns2:Order_Type>
    <ns2:Store_Order__ internalId="1992" scriptId="custbody_dj_store_order_number">
      <ns2:value>200306181</ns2:value>
    </ns2:Store_Order__>
    <ns2:Store_Order_Total internalId="1993" scriptId="custbody_dj_store_order_total">
      <ns2:value>361.56</ns2:value>
    </ns2:Store_Order_Total>
  </ns1:customFieldList>
</ns1:ReturnAuthorization>
*/

//Remove Element Based on Value with Element

import java.util.Properties;
import java.io.InputStream;
import java.util.*;
import org.jdom.input.SAXBuilder;
import org.jdom.Document;
import org.jdom.Namespace; 
import org.jdom.Element;
import org.jdom.xpath.XPath;
import org.jdom.output.XMLOutputter;
import org.jdom.output.Format;
import com.boomi.execution.ExecutionUtil;

logger = ExecutionUtil.getBaseLogger();

// Loop through the Process Documents
for ( int i = 0; i < dataContext.getDataCount(); i++ ) {

    InputStream is = dataContext.getStream(i);
    Properties props = dataContext.getProperties(i);

    // Build XML Document
    SAXBuilder builder = new SAXBuilder();
    Document doc = builder.build(is);

    //Parse through xml to get the child elements of EventLists
    Namespace ns1 = Namespace.getNamespace("ns1", "urn:customers_2016_2.transactions.webservices.netsuite.com");
    Namespace ns2 = Namespace.getNamespace("ns2", "urn:core_2016_2.platform.webservices.netsuite.com");

    //XPath x = XPath.newInstance("//ns1:ReturnAuthorization/ns1:itemList");
    //x.addNamespace("ns1","urn:customers_2016_2.transactions.webservices.netsuite.com");

    //Element parent = x.selectSingleNode(doc);

    Element rootNode = doc.getRootElement();
    Element itemListNode = rootNode.getChild("itemList",ns1);

    Element childItem = new Element("item",ns1);
    //childItem.setPrefix("ns1");
    Element childItemItem = new Element("item",ns1);
    childItemItem.setText("1234");
    //childItemItem.setPrefix("ns1");
    childItem.addContent(childItemItem);
    itemListNode.addContent(childItem);

    // Output the Document's data to an InputStream to pass to the next step in in process
    XMLOutputter outputter = new XMLOutputter();
    is = new ByteArrayInputStream(outputter.outputString(doc).getBytes("UTF-8"));

    dataContext.storeStream(is, props);

}
